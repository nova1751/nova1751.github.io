'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _chalk = require('chalk');

var _chalk2 = _interopRequireDefault(_chalk);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

class StatsPlugin {
  constructor({ spinner }) {
    this.spinner = spinner;
    this.prevLog = '';
    this.started = false;
  }

  apply(compiler) {
    compiler.plugin('compile', () => {
      if (!this.started) {
        this.spinner.start();
        this.started = true;
      }
    });
    compiler.plugin('done', stats => {
      this.spinner.stop();
      if (stats.hasErrors() || stats.hasWarnings()) {
        console.log(stats.toString('errors-only'));
      } else {
        const newLog = _chalk2.default.green('  Compiled successfully!');
        console.log('wo', newLog, this.prevLog);
        if (newLog !== this.prevLog) {
          console.log(newLog);
          this.prevLog = newLog;
        }
      }
    });
  }
}
exports.default = StatsPlugin;